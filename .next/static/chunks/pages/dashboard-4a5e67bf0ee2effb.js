(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{173:(e,n,t)=>{"use strict";t.d(n,{S:()=>d,U:()=>i});var a=t(7876),s=t(4232);let o={location:null,weather:null};function l(e,n){switch(n.type){case"SET_LOCATION":return{...e,location:n.payload};case"SET_WEATHER":return{...e,weather:n.payload};default:return e}}let r=(0,s.createContext)(void 0),d=e=>{let{children:n}=e,[t,d]=(0,s.useReducer)(l,o);return(0,a.jsx)(r.Provider,{value:{state:t,dispatch:d},children:n})},i=()=>{let e=(0,s.useContext)(r);if(!e)throw Error("useWeather must be used within a WeatherProvider");return e}},1782:()=>{throw Error("Module build failed (from ./node_modules/next/dist/compiled/mini-css-extract-plugin/loader.js):\nHookWebpackError: Module build failed (from ./node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js):\nError: It looks like you're trying to use `tailwindcss` directly as a PostCSS plugin. The PostCSS plugin has moved to a separate package, so to continue using Tailwind CSS with PostCSS you'll need to install `@tailwindcss/postcss` and update your PostCSS configuration.\n    at We (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/tailwindcss/dist/lib.js:35:2121)\n    at LazyResult.runOnRoot (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:329:16)\n    at LazyResult.runAsync (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:258:26)\n    at LazyResult.async (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:160:30)\n    at LazyResult.then (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:404:17)\n    at tryRunOrWebpackError (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:316119)\n    at __webpack_require_module__ (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:131532)\n    at __nested_webpack_require_161494__ (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:130967)\n    at /Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:131824\n    at symbolIterator (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/neo-async/async.js:1:14444)\n    at done (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/neo-async/async.js:1:14824)\n    at Hook.eval [as callAsync] (eval at create (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:14:9224), <anonymous>:15:1)\n    at Hook.CALL_ASYNC_DELEGATE [as _callAsync] (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:14:6378)\n    at /Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:130687\n    at symbolIterator (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/neo-async/async.js:1:14402)\n-- inner error --\nError: Module build failed (from ./node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js):\nError: It looks like you're trying to use `tailwindcss` directly as a PostCSS plugin. The PostCSS plugin has moved to a separate package, so to continue using Tailwind CSS with PostCSS you'll need to install `@tailwindcss/postcss` and update your PostCSS configuration.\n    at We (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/tailwindcss/dist/lib.js:35:2121)\n    at LazyResult.runOnRoot (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:329:16)\n    at LazyResult.runAsync (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:258:26)\n    at LazyResult.async (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:160:30)\n    at LazyResult.then (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:404:17)\n    at Object.<anonymous> (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/build/webpack/loaders/css-loader/src/index.js??ruleSet[1].rules[7].oneOf[11].use[1]!/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js??ruleSet[1].rules[7].oneOf[11].use[2]!/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/leaflet/dist/leaflet.css:1:7)\n    at /Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:962717\n    at Hook.eval [as call] (eval at create (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:14:9002), <anonymous>:7:1)\n    at Hook.CALL_DELEGATE [as _call] (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:14:6272)\n    at /Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:131565\n    at tryRunOrWebpackError (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:316073)\n    at __webpack_require_module__ (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:131532)\n    at __nested_webpack_require_161494__ (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:130967)\n    at /Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/webpack/bundle5.js:29:131824\n    at symbolIterator (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/compiled/neo-async/async.js:1:14444)\n\nGenerated code for /Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/build/webpack/loaders/css-loader/src/index.js??ruleSet[1].rules[7].oneOf[11].use[1]!/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js??ruleSet[1].rules[7].oneOf[11].use[2]!/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/leaflet/dist/leaflet.css\n1 | throw new Error(\"Module build failed (from ./node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js):\\nError: It looks like you're trying to use `tailwindcss` directly as a PostCSS plugin. The PostCSS plugin has moved to a separate package, so to continue using Tailwind CSS with PostCSS you'll need to install `@tailwindcss/postcss` and update your PostCSS configuration.\\n    at We (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/tailwindcss/dist/lib.js:35:2121)\\n    at LazyResult.runOnRoot (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:329:16)\\n    at LazyResult.runAsync (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:258:26)\\n    at LazyResult.async (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:160:30)\\n    at LazyResult.then (/Users/shahzelehsan/Downloads/weather-dashboard-final 2/frontend/node_modules/next/node_modules/postcss/lib/lazy-result.js:404:17)\");")},6303:(e,n,t)=>{"use strict";t.r(n),t.d(n,{__N_SSP:()=>S,default:()=>D});var a=t(7876),s=t(4232),o=t(553),l=t(9099),r=t(1040);function d(e){let{onSearch:n}=e,[t,o]=(0,s.useState)("");return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=t.trim();a&&(n(a),o(""))},"data-testid":"search-form",className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[(0,a.jsx)("input",{type:"text","aria-label":"City",value:t,onChange:e=>o(e.target.value),placeholder:"Enter city",className:"border border-gray-300 rounded px-3 py-2 w-full sm:w-auto flex-1"}),(0,a.jsx)("button",{type:"submit",disabled:!t.trim(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:"Search"})]})}let i=(0,s.createContext)(null);function u(){let e=(0,s.use)(i);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var c=t(6895),h=t.n(c);let f=(0,s.forwardRef)(function({bounds:e,boundsOptions:n,center:t,children:a,className:o,id:l,placeholder:r,style:d,whenReady:u,zoom:h,...f},p){let[m]=(0,s.useState)({className:o,id:l,style:d}),[w,b]=(0,s.useState)(null),x=(0,s.useRef)(void 0);(0,s.useImperativeHandle)(p,()=>w?.map??null,[w]);let y=(0,s.useCallback)(a=>{if(null!==a&&!x.current){let s=new c.Map(a,f);x.current=s,null!=t&&null!=h?s.setView(t,h):null!=e&&s.fitBounds(e,n),null!=u&&s.whenReady(u),b(Object.freeze({__version:1,map:s}))}},[]);(0,s.useEffect)(()=>()=>{w?.map.remove()},[w]);let _=w?s.createElement(i,{value:w},a):r??null;return s.createElement("div",{...m,ref:y},_)});var p=t(8477);function m(e,n){let t=(0,s.useRef)(n);(0,s.useEffect)(function(){n!==t.current&&null!=e.attributionControl&&(null!=t.current&&e.attributionControl.removeAttribution(t.current),null!=n&&e.attributionControl.addAttribution(n)),t.current=n},[e,n])}function w(e,n){let t=(0,s.useRef)(void 0);(0,s.useEffect)(function(){return null!=n&&e.instance.on(n),t.current=n,function(){null!=t.current&&e.instance.off(t.current),t.current=null}},[e,n])}function b(e,n){let t=e.pane??n.pane;return t?{...e,pane:t}:e}function x(e,n,t){return Object.freeze({instance:e,context:n,container:t})}function y(e,n){return null==n?function(n,t){let a=(0,s.useRef)(void 0);return a.current||(a.current=e(n,t)),a}:function(t,a){let o=(0,s.useRef)(void 0);o.current||(o.current=e(t,a));let l=(0,s.useRef)(t),{instance:r}=o.current;return(0,s.useEffect)(function(){l.current!==t&&(n(r,t,l.current),l.current=t)},[r,t,n]),o}}function _(e){return function(n){var t;let a=u(),o=e(b(n,a),a);return m(a.map,n.attribution),w(o.current,n.eventHandlers),t=o.current,(0,s.useEffect)(function(){return(a.layerContainer??a.map).addLayer(t.instance),function(){a.layerContainer?.removeLayer(t.instance),a.map.removeLayer(t.instance)}},[a,t]),o}}let j=function(e,n){var t;return t=_(y(e,n)),(0,s.forwardRef)(function(e,n){let{instance:a}=t(e).current;return(0,s.useImperativeHandle)(n,()=>a),null})}(function({url:e,...n},t){return x(new c.TileLayer(e,b(n,t)),t)},function(e,n,t){let{opacity:a,zIndex:s}=n;null!=a&&a!==t.opacity&&e.setOpacity(a),null!=s&&s!==t.zIndex&&e.setZIndex(s);let{url:o}=n;null!=o&&o!==t.url&&e.setUrl(o)}),v=function(e,n){var t;return t=_(y(e,n)),(0,s.forwardRef)(function(e,n){let{instance:a,context:o}=t(e).current;(0,s.useImperativeHandle)(n,()=>a);let{children:l}=e;return null==l?null:s.createElement(i,{value:o},l)})}(function({position:e,...n},t){var a;let s=new c.Marker(e,n);return x(s,(a={overlayContainer:s},Object.freeze({...t,...a})))},function(e,n,t){n.position!==t.position&&e.setLatLng(n.position),null!=n.icon&&n.icon!==t.icon&&e.setIcon(n.icon),null!=n.zIndexOffset&&n.zIndexOffset!==t.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),null!=n.opacity&&n.opacity!==t.opacity&&e.setOpacity(n.opacity),null!=e.dragging&&n.draggable!==t.draggable&&(!0===n.draggable?e.dragging.enable():e.dragging.disable())}),z=function(e,n){var t,a;return t=y(e),a=function(e,a){let s=u(),o=t(b(e,s),s);return m(s.map,e.attribution),w(o.current,e.eventHandlers),n(o.current,s,e,a),o},(0,s.forwardRef)(function(e,n){let[t,o]=(0,s.useState)(!1),{instance:l}=a(e,o).current;(0,s.useImperativeHandle)(n,()=>l),(0,s.useEffect)(function(){t&&l.update()},[l,t,e.children]);let r=l._contentNode;return r?(0,p.createPortal)(e.children,r):null})}(function(e,n){return x(new c.Popup(e,n.overlayContainer),n)},function(e,n,{position:t},a){(0,s.useEffect)(function(){let{instance:s}=e;function o(e){e.popup===s&&(s.update(),a(!0))}function l(e){e.popup===s&&a(!1)}return n.map.on({popupopen:o,popupclose:l}),null==n.overlayContainer?(null!=t&&s.setLatLng(t),s.openOn(n.map)):n.overlayContainer.bindPopup(s),function(){n.map.off({popupopen:o,popupclose:l}),n.overlayContainer?.unbindPopup(),n.map.removeLayer(s)}},[e,n,a,t])});t(1782),delete h().Icon.Default.prototype._getIconUrl,h().Icon.Default.mergeOptions({iconRetinaUrl:"/_next/static/media/marker-icon-2x.93fdb12c.png",iconUrl:"/_next/static/media/marker-icon.d577052a.png",shadowUrl:"/_next/static/media/marker-shadow.612e3b52.png"});let g=e=>{let{lat:n,lon:t,cityName:o}=e,[l,r]=(0,s.useState)([]),[d,i]=(0,s.useState)(!1),[u,c]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{i(!0),c(null);try{var e;let a=await fetch("https://api.weather.gov/alerts/active?point=".concat(n,",").concat(t));if(!a.ok)throw Error("API error: ".concat(a.status));let s=(null!=(e=(await a.json()).features)?e:[]).map(e=>({id:e.id,event:e.properties.event,headline:e.properties.headline,severity:e.properties.severity,description:e.properties.description}));r(s)}catch(e){console.error("Error fetching alerts",e),c("Failed to load weather alerts.")}finally{i(!1)}})()},[n,t]),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Radar & Alerts for ",o||"Selected Location"]}),(0,a.jsxs)(f,{center:[n,t],zoom:7,scrollWheelZoom:!1,className:"w-full h-[400px] rounded shadow border",children:[(0,a.jsx)(j,{attribution:'\xa9 <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,a.jsx)(v,{position:[n,t],children:(0,a.jsx)(z,{children:o})})]}),d&&(0,a.jsx)("p",{className:"mt-4 text-gray-500",children:"Loading alerts..."}),u&&(0,a.jsx)("p",{className:"mt-4 text-red-500",children:u}),!d&&!u&&(l.length>0?(0,a.jsxs)("div",{className:"mt-4 p-4 border border-yellow-400 bg-yellow-100 rounded",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"⚠️ Weather Alerts"}),(0,a.jsx)("ul",{className:"mt-2 space-y-2",children:l.map(e=>(0,a.jsxs)("li",{className:"border p-2 rounded bg-white shadow",children:[(0,a.jsxs)("p",{className:"font-bold",children:[e.event," — ",(0,a.jsx)("span",{className:"text-red-500",children:e.severity})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.headline}),(0,a.jsx)("p",{className:"text-xs mt-1",children:e.description})]},e.id))})]}):(0,a.jsx)("p",{className:"mt-4 text-sm text-gray-500",children:"No active alerts for this area."}))]})};var k=t(173),S=!0;function D(){var e;let{data:n,status:t}=(0,o.useSession)(),i=(0,l.useRouter)(),{state:u,dispatch:c}=(0,k.U)(),[h,f]=(0,s.useState)([]);(0,s.useEffect)(()=>{"unauthenticated"===t&&i.push("/login")},[t,i]),(0,s.useEffect)(()=>{var e;(null==n||null==(e=n.user)?void 0:e.email)&&r.A.get("".concat("https://weather-backend-w0w1.onrender.com","/locations/").concat(n.user.email)).then(e=>f(e.data)).catch(e=>console.error("Failed to load locations",e))},[n]);let p=async e=>{try{let n=await r.A.get("".concat("https://weather-backend-w0w1.onrender.com","/weather/forecast?city=").concat(e));c({type:"SET_LOCATION",payload:e}),c({type:"SET_WEATHER",payload:n.data})}catch(e){console.error("Weather fetch error:",e)}},m=async()=>{var e;if(!(null==n||null==(e=n.user)?void 0:e.email)||!u.weather)return;let{location:t}=u.weather;try{await r.A.post("".concat("https://weather-backend-w0w1.onrender.com","/locations"),{userEmail:n.user.email,cityName:t.name,lat:t.lat,lon:t.lon}),alert("Location saved!")}catch(e){console.error("Save failed:",e)}},w=async e=>{try{await r.A.delete("".concat("https://weather-backend-w0w1.onrender.com","/locations/").concat(e)),f(n=>n.filter(n=>n._id!==e))}catch(e){console.error("Delete failed:",e)}};return"loading"===t?(0,a.jsx)("div",{className:"p-4",children:"Loading..."}):(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold mb-4",children:["Welcome, ",null==n||null==(e=n.user)?void 0:e.email]}),(0,a.jsx)(d,{onSearch:p}),u.weather&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded p-4 mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:u.weather.location.name}),(0,a.jsxs)("p",{className:"text-gray-600",children:[u.weather.current.temp_c,"\xb0C – ",u.weather.current.condition.text]}),(0,a.jsx)("button",{onClick:m,className:"mt-2 px-4 py-1 bg-blue-600 text-white rounded",children:"Save Location"})]}),(0,a.jsx)(g,{lat:u.weather.location.lat,lon:u.weather.location.lon,cityName:u.weather.location.name})]}),h.length>0&&(0,a.jsxs)("div",{className:"mt-10",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Your Saved Locations"}),(0,a.jsx)("ul",{className:"space-y-2",children:h.map(e=>(0,a.jsxs)("li",{className:"flex justify-between bg-gray-100 p-2 rounded",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)("button",{onClick:()=>w(e._id),className:"text-sm text-red-600",children:"Delete"})]},e._id))})]})]})}},7580:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(6303)}])},9099:(e,n,t)=>{e.exports=t(8253)}},e=>{e.O(0,[805,40,553,636,593,792],()=>e(e.s=7580)),_N_E=e.O()}]);